# aind-ibl-capsule-converter

This capsule runs the ibl conversion with the manifest generated by the ibl-smartspim-conversion-launcher streamlit app: https://github.com/AllenNeuralDynamics/ibl-smartspim-conversion-launcher. [Capsule Link](https://codeocean.allenneuraldynamics.org/capsule/0325751/tree). The manifest is formatted as follows: 

| index | mouseid | sorted_recording | probe_file | probe_name | probe_shank | probe_id | surface_finding | annotation_format |
|-------|---------|------------------|------------|------------|-------------|----------|------------------|--------------------|
|       |         |                  |            |            |             |          |                  |                    |

The output is an asset in Code Ocean that has the IBL transformed data. See asset here for more details: 
https://codeocean.allenneuraldynamics.org/data-assets/33c8ae97-bb8c-423b-b4b1-3c551224c304/SmartSPIM_776293_2025-03-04_11-24-35_ibl-converted_2025-04-25_13-11-23

### Running capsule stand alone
If you have a manifest already made and just want to run this capsule as is, then probably the best method is to duplicate with the connection to git enabled. Then, manually attach the necessary assets below for the sessions in the manifest:
* Primary ecephys asset for each session
* Sorted ecephys asset for each session
* Primary SmartSPIM asset for subject
* Stitched SmartSPIM asset for subject
* Upload manifest to data folder
* Upload neuroglancer json to data folder

Then, in the app panel (shown) below, set the fields for manifest and neuroglancer json by pasting the path for each respective one. 
![image](https://github.com/user-attachments/assets/bd2c505c-e498-44a8-9a6f-0ae35414a1d4)

After it runs, you will have to manually create an asset. When creating the asset make sure to do it at the level of the `Run with Parameters...`. 


